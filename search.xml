<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CCNP交换综合实验一</title>
    <url>/2019/02/18/CCNP%E4%BA%A4%E6%8D%A2%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80/</url>
    <content><![CDATA[<p>&emsp;&emsp;本篇文章主要介绍VLAN、TRUNK、VTP 的作用和配置；DTP 的作用和配置；DHCP 及 DHCP 中继的作用和配置；掌握以太通道技术的作用和配置。</p>
<a id="more"></a>

<p>【实验目的】</p>
<ol>
<li><p>掌握 VLAN、TRUNK、VTP 的作用和配置</p>
</li>
<li><p>掌握 DTP 的作用和配置</p>
</li>
<li><p>掌握 DHCP 及 DHCP 中继的作用和配置</p>
</li>
<li><p>掌握以太通道技术的作用和配置</p>
</li>
</ol>
<p>【实验拓扑】</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTTPG6.png"></p>
<p>【实验需求】</p>
<ol>
<li>参考图示，完成物理拓扑的搭建。</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/28/dTeUVH.png"></p>
<ol start="2">
<li>在该园区网络中有 4 个 VLAN，分别为 VLAN10、VLAN20、VLAN30 和VLAN40，其中 DHCP SRV 和 PC1 在 VLAN10 中，PC2、PC3 分别在VLAN20和 VLAN30 中，FTP SRV 和 PC4 在 VLAN40 中，其中 VLAN10 的地址段为192.168.10.0/24，VLAN20 的地址段为 192.168.20.0/24，VLAN30 的地址段为 192.168.30.0/24，VLAN40 的地址段为 192.168.40.0/24，各 VLAN 主机的网关都设置为其网段中可用的最后一个主机地址，并且设置 DHCP 服务器的 IP 地址为 192.168.10.100/24，其他主机通过 DHCP 方式获取 IP 地址, 园区网络外部的地址自己规划。</li>
</ol>
<p>&emsp;①网关地址：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/28/dTexRx.png"></p>
<p>&emsp;②各主机通过DHCP获取IP地址：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTL0r8.png"></p>
<ol start="3">
<li>采用合适的方式完成交换机链路间的 TRUNK 配置，并采用标准的封装模式。</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTLbGR.png"></p>
<ol start="4">
<li>设置 SW1 的 VTP 模式为 Server，SW2 的 VTP 模式为 Client，并且设置 VTP 域名为 Company.com，密码为 CCIEPASS，实现该园区网络的 VLAN 信息同步。</li>
</ol>
<p>&emsp;&emsp;对SW1和SW2VTP进行设置：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTOLkQ.png"></p>
<p>&emsp;&emsp;SW2的VLAN信息：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTnjv6.png"></p>
<ol start="5">
<li>使用 802.3ad 标准构建两交换机间的以太通道链路, 要求交换机将EtherChannel 的负载均衡设置为 src-dst-ip</li>
</ol>
<p>&emsp;&emsp;证捆绑端口的特性都是一样，所以都配置成trunk端口。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTu9Ve.png"></p>
<ol start="6">
<li>根据需求在 DHCP SRV 上建立相应的地址池，并且在各个地址池中排除范围从 10 到 20 之间的 IP 地址空间，同时要求无论 FTP SRV 何时接入交换网络都会获取到 192.168.40.100/24 的地址。</li>
</ol>
<p>&emsp;&emsp;在各地址池中排除10-20的IP地址：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTuP5d.png"></p>
<p>&emsp;&emsp;在DHCP_Srv中建立一个特定的地址池用使FTP_Srv何时接入交换网络都会获取到 192.168.40.100/24 的地址（由于不知道FTP_Srv的MAC地址，所以先让FTP_Srv使用DHCP获取IP地址，再从DHCP_Srv的 ip dhcp pool binding 得到FTP_Srv的电路ID进行绑定）。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTuExP.png"></p>
<p>FTP_Srv用DHCP获取IP地址：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTuer8.png"></p>
<ol start="7">
<li>完成其他必要的配置，实现各主机和 FTP SRV 可以获取相应的 IP 地址，并且实现各主机可以访问 ISP 上的 Web SRV。</li>
</ol>
<p>&emsp;①启用OSPF实现内网全网可达：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/d7sGvt.png"></p>
<p>&emsp;②实现外网可达：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/d7sLVO.png"></p>
<p>③  配置NAT：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/d7s6K0.png"></p>
<p>④  用R1给邻居下发默认路由：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTuqeS.png"></p>
<p>⑤  主机可以访问 ISP 上的 Web SRV：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/29/dTuLdg.png"></p>
<p>【实验中用到的代码】</p>
<p><strong>VTP：</strong></p>
<p>vtp mode server———————————————将VTP的模式该为server模式</p>
<p>vtp domain Company.com ——————————–将VTP的域名改为Company.com</p>
<p>vtp password CCIEPASS————————————–密码设置为CCIEPASS</p>
<p>vtp mode client————————————————将VTP的模式该为client模式（该模式下不能对VLAN进行设置）</p>
<p>当域名与密码相同时才能进行同步</p>
<p>NAT：</p>
<p>access-list 1 permit 192.168.0.0 0.0.255.255———–匹配感兴趣流量（通过ACL来实现）</p>
<p>ip nat inside source list 1 interface e0/1 overload——将ACL使用在NAT中</p>
<p>int e0/0<br> ip nat inside<br> int e0/1<br> ip nat outside——————————————————–指定内、外接口</p>
<p>捆绑链路：</p>
<p>int range e0/1-2</p>
<p>switchport truck encapsulation do1q</p>
<p>switchport mode truck————————————-保证捆绑端口的特性都是一样，所以都配置成trunk端口</p>
<p>channel-protocol lacp—————————————指定捆绑协议lacp；可选</p>
<p>channel-group 1 mode active—————————–创建端口捆绑组号码，组号码是本地有效的，模式为active</p>
<p>下发默认路由：</p>
<p>router ospf 1</p>
<p>default-information originate—————————–给邻居下发默认路由</p>
]]></content>
      <categories>
        <category>CCNP实验</category>
      </categories>
      <tags>
        <tag>CCNP</tag>
        <tag>交换</tag>
      </tags>
  </entry>
  <entry>
    <title>CCNP交换综合实验三</title>
    <url>/2019/03/14/CCNP%E4%BA%A4%E6%8D%A2%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%89/</url>
    <content><![CDATA[<p>&emsp;&emsp;本篇文章主要介绍了 HSRP 的配置与检验；掌握 VRRP 的配置与检验；GLBP 的配置与检验； NTP、Syslog、SNMP、Track 以及 SPAN 技术的应用与配置</p>
<a id="more"></a>

<p>【实验目的】</p>
<ol>
<li><p>掌握 HSRP 的配置与检验</p>
</li>
<li><p>掌握 VRRP 的配置与检验</p>
</li>
<li><p>掌握 GLBP 的配置与检验</p>
</li>
<li><p>熟悉 NTP、Syslog、SNMP、Track 以及 SPAN 技术的应用与配置</p>
</li>
</ol>
<p>【实验拓扑】</p>
<p> <img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/djuPsJ.png"></p>
<p>【实验需求】</p>
<ol>
<li>参考图示，完成物理拓扑的搭建。</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/djxDrF.png"></p>
<ol start="2">
<li>根据图示，将各主机与 NMS 划分进相应的 VLAN 中，各主机以及 NMS 的地址自己规划，其中 NMS 是一台安装了 SNMP 网管软件、Syslog 日志服务器和网络嗅探器的网络管理服务器，并且两多层交换机做为各 PC 的网关。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在各交换机上创建vlan，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#vlan 10 </span></span><br><span class="line">DSW1(config)<span class="comment">#vlan 20 </span></span><br><span class="line">DSW1(config)<span class="comment">#vlan 30</span></span><br><span class="line"><span class="comment">#将NMS所在的端口划分进vlan 30</span></span><br><span class="line">DSW1(config)<span class="comment">#interface ethernet 0/2</span></span><br><span class="line">DSW1(config-if)<span class="comment">#switchport mode access </span></span><br><span class="line">DSW1(config-if)<span class="comment">#switchport access vlan 30</span></span><br><span class="line"><span class="comment">#配置各主机的IP地址，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#interface e0/0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no switchport </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 11.11.11.1 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface e0/1</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no switchport </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 21.21.21.1 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line"><span class="comment">#将其余与交换机相连的端口设置为trunk，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#interface range e0/3,e1/0</span></span><br><span class="line">DSW1(config-if-range)<span class="comment">#switchport trunk encapsulation dot1q </span></span><br><span class="line">DSW1(config-if-range)<span class="comment">#switchport mode trunk </span></span><br><span class="line"><span class="comment">#将各PC划分进对应的vlan，此处以ASW1为例。</span></span><br><span class="line">ASW1(config)<span class="comment">#interface range e0/1-2</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#switchport mode access </span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#switchport access vlan 10 </span></span><br><span class="line"><span class="comment">#在三层交换机上启用SVI端口作为各PC机的网关，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 192.168.10.252 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 192.168.10.252 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line"><span class="comment">#其余配置略</span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;各主机的端口配置情况（可以通过端口是否出现在vlan中来判断是否为trunk）：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxiAgA.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dvtr9J.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dvNS3j.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dvts39.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dvN8UO.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dvtBh4.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dvt0NF.png"></p>
<ol start="2">
<li>采用 HSRP 协议实现 VLAN10 的主网关为 DSW1，备份网关为 DSW2,VLAN20的主网关为 DSW2，备份网关为 DSW1,在园区网络内采用任意协议实现 PC 机可以访问 Internet 网络，HSRP 组编号应与它们为之提供服务的 VLAN 的编号匹配。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在DSW1上运行HSRP协议</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10</span></span><br><span class="line"><span class="comment">#配置vlan 10的虚拟网关为192.168.10.254（在HRSP协议中，虚拟IP不可以与实际物理IP相同）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 ip 192.168.10.254</span></span><br><span class="line"><span class="comment">#开启抢占模式（优先级高的设备可以抢占优先级低的设备成为主网关，默认关闭）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 preempt</span></span><br><span class="line"><span class="comment">#设置standby 10的优先级为110（可通过设置优先级来确定主/备份设备）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 priority 110</span></span><br><span class="line"><span class="comment">#开启认证，防止非法设备的接入</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 authentication md5 key-string huangzc</span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 20</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 ip 192.168.20.254</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 preempt </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 priority 105</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 authentication md5 key-string huangzc</span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line"><span class="comment">#在DSW2上运行HSRP协议</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 ip 192.168.10.254 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 priority 105 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 authentication md5 key-string huangzc</span></span><br><span class="line">DSW2(config-if)<span class="comment">#exit</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 20 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 ip 192.168.20.254 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 priority 110 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 authentication md5 key-string huangzc</span></span><br><span class="line">DSW2(config-if)<span class="comment">#exit</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxi3gs.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxi13j.png"></p>
<ol start="4">
<li>当多层交换机的上行链路发生故障，确保来自 PC 的流量不会采用次优路径。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#创建track 10 跟踪DSW1上层链路interface e0/0的状态</span></span><br><span class="line">DSW1(config)<span class="comment">#track 10 interface e0/0 line-protocol </span></span><br><span class="line">DSW1(config-track)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line"><span class="comment">#当上层链路发生故障时，DSW1的优先级减少6小于DSW2的105，DSW2成为主网关 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 track 10 decrement 6</span></span><br><span class="line"><span class="comment">#DSW2同理</span></span><br><span class="line">DSW2(config)<span class="comment">#track 20 interface e0/0 line-protocol  </span></span><br><span class="line">DSW2(config-track)<span class="comment">#exit</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 track 20 decrement 6</span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;关闭DSW1上e0/0的端口，用追踪路由查看路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DSW1(config)<span class="comment">#interface e0/0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#shutdown </span></span><br><span class="line">*Sep  1 08:21:57.629: %TRACK-6-STATE: 10 interface Et0/0 line-protocol Up -&gt; Down</span><br><span class="line">*Sep  1 08:21:59.634: %LINK-5-CHANGED: Interface Ethernet0/0, changed state to administratively down</span><br><span class="line">*Sep  1 08:22:00.239: %HSRP-5-STATECHANGE: Vlan10 Grp 10 state Active -&gt; Speak</span><br><span class="line">*Sep  1 08:22:00.637: %LINEPROTO-5-UPDOWN: Line protocol on Interface Ethernet0/0,changed state to down</span><br><span class="line">*Sep  1 08:22:11.522: %HSRP-5-STATECHANGE: Vlan10 Grp 10 state Speak -&gt; Standby</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;由于DSW1的e0/0端口被关闭，优先级减少6，小于DSW2的105，故DSW1的Group 10状态转为Standby，DSW2的Group 10状态转为Active。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxmmt0.png"></p>
<p>在PC 1上进行对Internet的路由跟踪，从下图可以得知，数据是从DSW2上转发的。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxmDnH.png"></p>
<ol start="5">
<li>删除 HSRP 的配置，使用 VRRP 实现 VLAN10 的主网关为 DSW1，备份网关为 DSW2,VLAN20 的主网关为 DSW2，备份网关为 DSW1, VRRP 组编号应与它们为之提供服务的 VLAN 的编号匹配，如果多层交换机的上行链路发生故障，同样请确保来自 PC 的流量不会采用次优路径。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在DSW1上运行VRRP协议</span></span><br><span class="line">DSW1(config-if)<span class="comment">#interface vlan 10 </span></span><br><span class="line"><span class="comment">#配置vlan 10的虚拟网关为192.168.10.254（在VRRP协议中，虚拟IP可以与实际物理IP相同）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 10 ip 192.168.10.254</span></span><br><span class="line"><span class="comment">#开启抢占模式（优先级高的设备可以抢占优先级低的设备成为主网关，默认开启）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 10 preempt </span></span><br><span class="line"><span class="comment">#设置vrrp 10的优先级为110（可通过设置优先级来确定主/备份设备）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 10 priority 110</span></span><br><span class="line"><span class="comment">#开启认证，防止非法设备的接入</span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 10 authentication text huangzc</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 20 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 20 ip 192.168.20.254 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 20 preempt </span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 20 priority 105</span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 20 authentication text huangzc</span></span><br><span class="line"><span class="comment">#在DSW2上运行VRRP协议</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 10 ip 192.168.10.254</span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 10 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 10 priority 105 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 10  authentication text huangzc</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 20 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 20 ip 192.168.20.254</span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 20 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 20 priority 110 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 20  authentication text huangzc</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxoMGD.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxoQRe.png"></p>
<p>&emsp;&emsp;使用track使 PC 的流量不会采用次优路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#创建track 10 跟踪DSW1上层链路interface e0/0的状态</span></span><br><span class="line">DSW1(config)<span class="comment">#track 10 interface e0/0 line-protocol </span></span><br><span class="line">DSW1(config-track)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line"><span class="comment">#当上层链路发生故障时，DSW1的优先级减少6小于DSW2的105，DSW2成为主网关 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#vrrp 10 track 10 decrement 6</span></span><br><span class="line"><span class="comment">#DSW2同理</span></span><br><span class="line">DSW2(config)<span class="comment">#track 20 interface e0/0 line-protocol  </span></span><br><span class="line">DSW2(config-track)<span class="comment">#exit</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 20 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#vrrp 20 track 20 decrement 6</span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;关闭DSW2 的e0/0, 用追踪路由查看路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DSW2(config)<span class="comment">#interface e0/0</span></span><br><span class="line">DSW2(config-if)<span class="comment">#shutdown </span></span><br><span class="line">*Sep  1 09:03:34.438: %TRACK-6-STATE: 20 interface Et0/0 line-protocol Up -&gt; Down</span><br><span class="line">*Sep  1 09:03:34.443: %OSPF-5-ADJCHG: Process 110, Nbr 12.12.12.2 on Ethernet0/0 from FULL to DOWN, Neighbor Down: Interface down or detached</span><br><span class="line">*Sep  1 09:03:36.441: %LINK-5-CHANGED: Interface Ethernet0/0, changed state to administratively down</span><br><span class="line">*Sep  1 09:03:37.449: %LINEPROTO-5-UPDOWN: Line protocol on Interface Ethernet0/0, changed state to down</span><br><span class="line">*Sep  1 09:03:37.722: %VRRP-6-STATECHANGE: Vl20 Grp 20 state Master -&gt; Backup</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;由于DSW2的e0/0端口被关闭，优先级减少6，小于DSW2的105，故DSW2的Group 20状态转为Backup，DSW1的Group 10状态转为Master。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxrEz8.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxrmLQ.png"></p>
<ol start="6">
<li>删除 VRRP 的配置，在该园区网络中部署 GLBP 实现各 VLAN 的主机可以同时通过DSW1 和DSW2 进行外部网络资源的访问，并且实现DSW1 为VLAN10 的 AVG，DSW2 为 VLAN20 的 AVG。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在DSW1上运行GLBP协议</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line"><span class="comment">#配置vlan 10的虚拟网关为192.168.10.254（在GLBP协议中，虚拟IP不可以与实际物理IP相同）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 ip 192.168.10.254</span></span><br><span class="line"><span class="comment">#开启抢占模式（优先级高的设备可以抢占优先级低的设备成为主网关，默认关闭）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 preempt </span></span><br><span class="line"><span class="comment">#设置glbp 10的优先级为120（可通过设置优先级来确定AVG/AVF设备）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 priority 120 </span></span><br><span class="line"><span class="comment">#开启认证，防止非法设备的接入</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 authentication md5 key-string huangzc</span></span><br><span class="line"><span class="comment">#修改负载均衡方式</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 load-balancing weighted </span></span><br><span class="line"><span class="comment">#修改权重为140。（最低为100，最高为140。如果权重低于100，将不能进行数据的转发。如果想恢复转发数据，那么权重必须大于或等于140）</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 weighting 140 lower 100 upper 140</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 20 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 20 ip 192.168.20.254</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 20 preempt </span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 20 priority 110 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 20 authentication md5 key-string huangzc</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 20 load-balancing weighted </span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 20 weighting 140 lower 100 upper 140</span></span><br><span class="line"><span class="comment">#在DSW2上运行GLBP协议</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 10 ip 192.168.10.254</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 10 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 10 priority 110</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 10 authentication md5 key-string huangzc</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 10 load-balancing weighted </span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 10 weighting 140 lower 100 upper 140</span></span><br><span class="line">DSW2(config-if)<span class="comment">#interface vlan 20</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 ip 192.168.20.254</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 priority 120 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 authentication md5 key-string huangzc</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 load-balancing weighted </span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 weighting 140 lower 100 upper 140</span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;查看GLBP的详细信息，DSW1为Vlan 10的AVG，负责分发虚拟MAC地址，AVG同时也可以是AVF。DSW2为Vlan 20的AVF。DSW2为Vlan 20的AVG，负责分发虚拟MAC地址，同时也是AVF。DSW1为Vlan 20的AVF。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxWAK0.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxWVbT.png"></p>
<p>&emsp;&emsp;在PC1与PC2上对路由进行跟踪，PC1的数据由DSW1转发，PC2的数据由DSW2转发。实现负载均衡。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dx4ma8.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dx4MGQ.png"></p>
<p>&emsp;&emsp;使用track使 PC 的流量不会采用次优路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#创建track 10 跟踪DSW1上层链路interface e0/0的状态</span></span><br><span class="line">DSW1(config)<span class="comment">#track 10 interface e0/0 line-protocol </span></span><br><span class="line">DSW1(config-track)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line"><span class="comment">#当上层链路发生故障时，DSW1的权重减少50为90，小于100，无法转发数据</span></span><br><span class="line">DSW1(config-if)<span class="comment">#glbp 10 weighting track 10 decrement 50</span></span><br><span class="line"><span class="comment">#DSW2同理</span></span><br><span class="line">DSW2(config)<span class="comment">#track 20 interface e0/0 line-protocol  </span></span><br><span class="line">DSW2(config-track)<span class="comment">#exit</span></span><br><span class="line">DSW2(config-if)<span class="comment">#interface vlan 20</span></span><br><span class="line">DSW2(config-if)<span class="comment">#glbp 20 weighting track 20 decrement 50</span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;关闭DSW2 的e0/0, 用追踪路由查看路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DSW1(config)<span class="comment">#interface e0/0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#shutdown </span></span><br><span class="line">*Sep  1 11:35:58.763: %TRACK-6-STATE: 10 interface Et0/0 line-protocol Up -&gt; Down</span><br><span class="line">*Sep  1 11:36:00.762: %LINK-5-CHANGED: Interface Ethernet0/0, changed state to administratively down</span><br><span class="line">*Sep  1 11:36:01.768: %LINEPROTO-5-UPDOWN: Line protocol on Interface Ethernet0/0, changed state to down</span><br><span class="line">*Sep  1 11:36:29.913: %GLBP-6-FWDSTATECHANGE: Vlan10 Grp 10 Fwd 2 state Active -&gt; Listen</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;当上层链路发生故障时，DSW1的Group 10的权重小于100，故不能转发数据，处于Listen状态。但是DSW1仍是Group 10 的AVG，它将原本自己的MAC地址分配给了DSW2的Group 10，因此，此时的DSW2的负责Vlan 10的所有数据转发。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxfxhQ.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxh9cn.png"></p>
<p>&emsp;&emsp;PC1与PC2访问Internet时，均为DSW2转发。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxhy4g.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/01/dxh2gs.png"></p>
<ol start="7">
<li>在路由器 R1 上设置路由器的当前时间为 12:00:00 Mar 7 2019，时区为 CN， NTP 的master 值为2，使用安全的方式实现多层交换通过R1 完成时钟同步。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1<span class="comment">#clock set 12:00:00 Mar 7 2019</span></span><br><span class="line">R1(config)<span class="comment">#clock timezone CN +8</span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;Server：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1(config)<span class="comment">#ntp master 2</span></span><br><span class="line">R1(config)<span class="comment">#int range e0/0-2</span></span><br><span class="line">R1(config-if-range)<span class="comment">#ntp broadcast </span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;Client :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DSW1(config)<span class="comment">#int e0/0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#ntp broadcast client </span></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>将多层交换以及 R1 上的日志信息发送到 NMS 上的 Syslog 日志服务器上， 并且设置这些设备的 Log Buffer 为 8192 bytes，logging trap 为 5。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1(config)<span class="comment">#logging buffered 8192</span></span><br><span class="line">R1(config)<span class="comment">#logging trap 5    </span></span><br><span class="line">R1(config)<span class="comment">#logging host 192.168.30.1</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>在 R1 上设置 SNMP 的 community 为huangzc，并且权限为 RW，通过 PC 机上的 SNMP 工具实现对 R1 设备的管理和监控。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R1(config)<span class="comment">#snmp-server community huangzc rw </span></span><br></pre></td></tr></table></figure>

<ol start="10">
<li>使用 SPAN 将 DSW1 上的 VLAN10 数据发送到 NMS 上进行流量分析。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DSW1(config)<span class="comment">#no monitor session all </span></span><br><span class="line">DSW1(config)<span class="comment">#monitor session 8 source vlan 10 </span></span><br><span class="line">DSW1(config)<span class="comment">#monitor session 8 destination interface e0/2</span></span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>CCNP实验</category>
      </categories>
      <tags>
        <tag>CCNP</tag>
        <tag>交换</tag>
      </tags>
  </entry>
  <entry>
    <title>CCNP交换综合实验二</title>
    <url>/2019/03/07/CCNP%E4%BA%A4%E6%8D%A2%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%BA%8C/</url>
    <content><![CDATA[<p>&emsp;&emsp;本篇文章主要介绍了 RSTP 的配置与检验； MST 的配置与检验；生成树特性的应用；实现 VLAN 间的通信。</p>
<a id="more"></a>

<p>【实验目的】</p>
<ol>
<li><p>掌握 RSTP 的配置与检验</p>
</li>
<li><p>掌握 MST 的配置与检验</p>
</li>
<li><p>掌握生成树特性的应用</p>
</li>
<li><p>实现 VLAN 间的通信</p>
</li>
</ol>
<p>【实验拓扑】</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOdkOP.png"></p>
<p>【实验需求】</p>
<ol>
<li>参考图示，完成物理拓扑的搭建。</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOdQln.png"></p>
<ol start="2">
<li>在该园区网络中有 4 个 VLAN，VLAN10、VLAN20、VLAN30 和 VLAN40，要求在 DSW1 上创建这些 VLAN，其他交换机同步 DSW1 上的 VLAN 信息，并且设置 VTP 域名为 huang.com，VTP 密码为 huang，所有 TRUNK 链路全部采用标准的封装模式。</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOdtkF.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOdwlR.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOdckD.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOwSBV.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOwk9J.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOwKAO.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOwovR.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOwrgs.png"></p>
<ol start="3">
<li>DSW1 与 DSW2 之间的链路不足以传递园区内部流量，使用合适的方式建立DSW1 与 DSW2 之间的以太通道链路。</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOBmFO.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOBnYD.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOBZTK.png"></p>
<ol start="4">
<li>要求全网启用基于 802.1w 标准的生成树，并且实现 DSW1 为 VLAN 10 和 20 的主根，为 VLAN 30 和 40 的次根，实现 DSW2 为 VLAN 10 和 20 的次根， 为 VLAN 30 和 40 的主根,并且哪怕将来在接入层中有新的交换机添加进园区网络，也要确保这两台交换机的地位。</li>
</ol>
<p>&emsp;&emsp;全网启用基于 802.1w 标准的生成树：</p>
<p> <img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dODsvd.png"></p>
<p>&emsp;&emsp;实现 DSW1 为 VLAN 10 和 20 的主根，为 VLAN 30 和 40 的次根，实现 DSW2 为 VLAN 10 和 20 的次根， 为 VLAN 30 和 40 的主根：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOrFVx.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOrPq1.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOrCrR.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOrAIK.png"></p>
<p>&emsp;&emsp;确保两台交换机的地位：</p>
<p> <img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOrka6.png"></p>
<ol start="5">
<li>各 PC 和 VLAN 的 IP 编址如下表：</li>
</ol>
<table>
<thead>
<tr>
<th><strong>设备</strong></th>
<th><strong>VLAN</strong></th>
<th><strong>IP 地址</strong></th>
<th><strong>默认网关</strong></th>
</tr>
</thead>
<tbody><tr>
<td>PC1</td>
<td>10</td>
<td>192.168.10.100</td>
<td>192.168.10.254</td>
</tr>
<tr>
<td>PC2</td>
<td>20</td>
<td>192.168.20.100</td>
<td>192.168.20.254</td>
</tr>
<tr>
<td>PC3</td>
<td>30</td>
<td>192.168.30.100</td>
<td>192.168.30.254</td>
</tr>
<tr>
<td>PC4</td>
<td>40</td>
<td>192.168.40.100</td>
<td>192.168.40.254</td>
</tr>
</tbody></table>
<ol start="6">
<li>要求连接这些主机的交换端口忽视生成树过程，能够直接进入到转发状态， 并且这些端口在接收到配置 BPDU 时就进入 err-disrable 状态。</li>
</ol>
<p>&emsp;&emsp;忽视生成树过程，直接进入到转发状态：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOcQ1S.png"></p>
<p>&emsp;&emsp;端口在接收到配置 BPDU 时就进入 err-disrable 状态：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOcMp8.png"></p>
<ol start="7">
<li>在 R1 上完成必要的配置，实现各 PC 间可以互相访问。</li>
</ol>
<p>&emsp;&emsp;配置单臂路由，实现各PC间可以互相访问：</p>
<p>&emsp;&emsp;①  将子接口划分进各个VLAN中</p>
<p>&emsp;&emsp;②  在子接口中配置各网段的网关地址 </p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOc1XQ.png"></p>
<p>&emsp;&emsp;③  PC间实现互相访问</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOcl6g.png"></p>
<ol start="8">
<li>随着网络规模的扩大，该园区网将来可能需要配置更多的 VLAN，大量的VLAN 实例会影响交换机的性能，要求将该客户网络迁移到 MST 中，具体MST 需求如下：</li>
</ol>
<ul>
<li><p>创建两个 MST 实例，MST1 和 MST2，其中 MST1 用于 VLAN 10 到 25, MST2 用于 VLAN 26 到 50，其它 VLAN 属于 CIST。</p>
</li>
<li><p>使用 MST 区域名“SWITCH”，修订号“1”。</p>
</li>
</ul>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dO2MLQ.png"></p>
<ul>
<li>将 DSW1 配置为 MST1 及 CIST 的主根，为 MST2 的次根。</li>
</ul>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dO2lZj.png"></p>
<ul>
<li>将 DSW2 配置为 MST2 的主根，为 MST1 及 CIST 的次根。</li>
</ul>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dO2JJ0.png"></p>
<p>&emsp;&emsp;实验结果：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTVFe.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTJYQ.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTUln.png"></p>
<ol start="9">
<li><p>该客户网络进行了升级，购买了两台新的多层交换机，升级之后的网络拓扑如下，其中客户所属的 VLAN 角色及地址段信息保持不变</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTBwT.png"></p>
</li>
<li><p>现要求你完成如下网络配置：</p>
</li>
</ol>
<ul>
<li><p>配置DSW1 和DSW2 以执行 VLAN 间路由。将 DSW1 用作与交换机ASW1 连接的 PC1 和 PC2 的默认网关。连接 DSW2 的客户端使用 DSW2 作为默认网关，所有 PC 都保留网络升级改造之前的 IP 地址和默认网关。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTv0f.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dO7SAS.png"></p>
</li>
<li><p>R1 与两多层交换机链路的 IP 地址，以及园区外部的 ISP 和 Web SRV 地址自行规划。</p>
</li>
</ul>
<p>&emsp;&emsp;各接口的具体地址如下图所示。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTx78.png"></p>
<ul>
<li><p>在园区网络内启用 OSPF，并且将园区网络划分到区域 0 中。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dOTjnP.png"></p>
</li>
<li><p>将 ASW1 和 DSW1 之间的链路捆绑到一个基于标准的 EtherChannel 中。</p>
</li>
</ul>
<p>&emsp;&emsp;具体实现方法已在3中详细列出，在此不在列出。</p>
<ul>
<li>完成其他必要配置，实现各 VLAN 间的用户可以互相通信，并且实现园区网络内的用户可以访问 ISP 上的 Web SRV。</li>
</ul>
<p>&emsp;&emsp;由于前面以实现内网全网可达，外网也实现了可达性。故只需在R1上配置NAT。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dXJ3bF.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dXJGE4.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dXJ1DU.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/31/dXJBDO.png"></p>
]]></content>
      <categories>
        <category>CCNP实验</category>
      </categories>
      <tags>
        <tag>CCNP</tag>
        <tag>交换</tag>
      </tags>
  </entry>
  <entry>
    <title>CCNP交换综合实验四</title>
    <url>/2019/03/21/CCNP%E4%BA%A4%E6%8D%A2%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E5%9B%9B/</url>
    <content><![CDATA[<p>&emsp;&emsp;本篇文章主要介绍了掌握交换端口安全的应用与配置；DHCP SNOOPING 的应用与配置；DAI 的应用与配置；IP SG 的应用与配置；PVLAN 的应用与配置；802.1x 的应用与配置 。</p>
<a id="more"></a>

<p>【实验目的】</p>
<ol>
<li><p>掌握交换端口安全的应用与配置</p>
</li>
<li><p>掌握 DHCP SNOOPING 的应用与配置</p>
</li>
<li><p>掌握 DAI 的应用与配置</p>
</li>
<li><p>掌握 IP SG 的应用与配置</p>
</li>
<li><p>熟悉 PVLAN 的应用与配置</p>
</li>
<li><p>熟悉 802.1x 的应用与配置 </p>
</li>
</ol>
<p>【实验拓扑】</p>
<p> <img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/wpEfUI.png"></p>
<p>【实验需求】</p>
<ol>
<li>参考图示，完成物理拓扑的搭建</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/wpEWVA.png"></p>
<ol start="2">
<li>根据图示，将各主机、DHCP 服务器以及 ACS 服务器划分进相应的 VLAN 中， 各 VLAN 地址段信息，以及路由器与多层交换间链路的地址自己规划，其中VLAN10 和 VLAN20 的主机通过 DHCP 方式获取 IP 地址。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在各交换机上创建vlan，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#vlan 10,20,30,40 </span></span><br><span class="line"><span class="comment">#将ACS所在的端口划分进vlan 30</span></span><br><span class="line">DSW1(config)<span class="comment">#interface ethernet 0/1</span></span><br><span class="line">DSW1(config-if)<span class="comment">#switchport mode access </span></span><br><span class="line">DSW1(config-if)<span class="comment">#switchport access vlan 30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置各主机的IP地址，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#interface e0/0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no switchport </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 11.11.11.1 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface e0/3</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no switchport </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 21.21.21.1 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将其余与交换机相连的端口设置为trunk，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#interface range e1/0-1</span></span><br><span class="line">DSW1(config-if-range)<span class="comment">#switchport trunk encapsulation dot1q </span></span><br><span class="line">DSW1(config-if-range)<span class="comment">#switchport mode trunk </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将各PC划分进对应的vlan，此处以ASW1为例。</span></span><br><span class="line">ASW1(config)<span class="comment">#interface range e0/1-2</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#switchport mode access </span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#switchport access vlan 10 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#在三层交换机上启用SVI端口作为各PC机的网关，此处以DSW1为例。</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 192.168.10.252 255.255.255.0</span></span><br><span class="line"><span class="comment">#由于各PC机与DHCP服务器不在同一Vlan中，所以需要配置DHCP中继来确保PC能够通过DHCP获取IP地址</span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip helper-address 192.168.40.100</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line">DSW1(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip address 192.168.10.252 255.255.255.0</span></span><br><span class="line">DSW1(config-if)<span class="comment">#ip helper-address 192.168.40.100</span></span><br><span class="line">DSW1(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DSW1(config-if)<span class="comment">#exit</span></span><br><span class="line"><span class="comment">#其余配置略</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w98NgH.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w98s58.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w93s1J.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w91tIO.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w91Eq0.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w91KG4.png"></p>
<ol start="3">
<li>在该园区网络内部署合适的第一跳冗余技术以及合适的路由协议，并且要求在正常情况下，DSW1 作为 VLAN10 主网关，DSW2 作为 VLAN20 的主网关， DSW1 和 DSW2 中的任何一台设备出现故障都不能影响用户的网络访问。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在DSW1上启用HRSP协议，使DSW1作为Vlan 10的主网关</span></span><br><span class="line">DSW1(config)<span class="comment">#track 10 interface e0/0 line-protocol </span></span><br><span class="line">DSW1(config)<span class="comment">#intterface vlan 10 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 ip 192.168.10.254</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 preempt </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 priority 110 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby authentication md5 key-string huangzc</span></span><br><span class="line"><span class="comment">#当上层链路发生故障时，DSW1的优先级减少6小于DSW2的105，DSW2成为Vlan 10的主网关 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 10 track 10 decrement 6</span></span><br><span class="line">DSW1(config-if)<span class="comment">#intterface vlan 20 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 ip 192.168.20.254 </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 preempt </span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 priority 105</span></span><br><span class="line">DSW1(config-if)<span class="comment">#standby 20 authentication md5 key-string huangzc</span></span><br><span class="line"><span class="comment">#在DSW2上启用HRSP协议，使DSW2作为Vlan 20的主网关</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 10 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 ip 192.168.10.254</span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 preempt  </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 priority 105</span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 10 authentication md5 key-string huangzc</span></span><br><span class="line">DSW2(config-if)<span class="comment">#exit </span></span><br><span class="line">DSW2(config)<span class="comment">#track 20 interface e0/0 line-protocol</span></span><br><span class="line">DSW2(config)<span class="comment">#interface vlan 20 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 ip 192.168.20.254</span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 preempt </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 priority 110</span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 authentication md5 key-string huangnzc</span></span><br><span class="line"><span class="comment">#当上层链路发生故障时，DSW2的优先级减少6小于DSW2的105，DSW1成为Vlan 20的主网关 </span></span><br><span class="line">DSW2(config-if)<span class="comment">#standby 20 track 20 decrement 6</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9J9wq.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9JFYT.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9Y6PK.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9Y8U0.png"></p>
<ol start="4">
<li>要求连接所有 PC 机和 SRV 的端口忽视生成树过程，直接跳转到转发状态。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DSW1(config)<span class="comment">#spanning-tree mode rapid-pvst  </span></span><br><span class="line">DSW1(config)<span class="comment">#interface e0/1</span></span><br><span class="line">DSW1(config-if)<span class="comment">#spanning-tree portfast edge </span></span><br><span class="line"></span><br><span class="line">DSW2(config)<span class="comment">#spanning-tree mode rapid-pvst </span></span><br><span class="line">DSW2(config)<span class="comment">#interface e0/1</span></span><br><span class="line">DSW2(config-if)<span class="comment">#spanning-tree portfast edge </span></span><br><span class="line"></span><br><span class="line">ASW1(config)<span class="comment">#spanning-tree mode rapid-pvst   </span></span><br><span class="line">ASW1(config)<span class="comment">#interface range e0/1-2</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#spanning-tree portfast </span></span><br><span class="line"></span><br><span class="line">ASW2(config)<span class="comment">#spanning-tree mode rapid-pvst      </span></span><br><span class="line">ASW2(config)<span class="comment">#interface range e0/1-2</span></span><br><span class="line">ASW2(config-if-range)<span class="comment">#spanning-tree portfast </span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>完成必要配置，实现 VLAN10 和 VLAN20 的主机可以通过 DHCP 获取 IP 地址，并且各主机可以访问因特网。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#配置DHCP服务器,使得vlan 10，vlan 20的主机通过DHCP的方式获取IP地址</span></span><br><span class="line">DHCP(config)<span class="comment">#interface e0/1</span></span><br><span class="line">DHCP(config-if)<span class="comment">#ip address 192.168.40.100 255.255.255.0</span></span><br><span class="line">DHCP(config-if)<span class="comment">#no shutdown </span></span><br><span class="line">DHCP(config-if)<span class="comment">#exit </span></span><br><span class="line">DHCP(config)<span class="comment">#ip dhcp pool vlan 10 </span></span><br><span class="line">DHCP(dhcp-config)<span class="comment">#network 192.168.10.0 255.255.255.0</span></span><br><span class="line">DHCP(dhcp-config)<span class="comment">#default-router 192.168.10.254 </span></span><br><span class="line">DHCP(dhcp-config)<span class="comment">#dns-server 8.8.8.8</span></span><br><span class="line">DHCP(config)<span class="comment">#ip dhcp pool vlan 20</span></span><br><span class="line">DHCP(dhcp-config)<span class="comment">#network 192.168.20.0 255.255.255.0</span></span><br><span class="line">DHCP(dhcp-config)<span class="comment">#default-router 192.168.20.254 </span></span><br><span class="line">DHCP(dhcp-config)<span class="comment">#dns-server 8.8.8.8</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9Ja7t.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9JwAP.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9JU0I.png"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9JNnA.png"></p>
<p>&emsp;&emsp;在R1上配置NAT，使各主机能够访问Internet</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#设置ACL，匹配感兴趣流量</span></span><br><span class="line">R1(config)<span class="comment">#access-list 1 permit 192.168.10.0 0.0.0.255 </span></span><br><span class="line">R1(config)<span class="comment">#access-list 1 permit 192.168.20.0 0.0.0.255 </span></span><br><span class="line"><span class="comment">#指定内外接口</span></span><br><span class="line">R1(config)<span class="comment">#interface e0/0</span></span><br><span class="line">R1(config-if)<span class="comment">#ip nat outside </span></span><br><span class="line">R1(config)<span class="comment">#int range e0/1-2</span></span><br><span class="line">R1(config-if-range)<span class="comment">#ip nat inside</span></span><br><span class="line"><span class="comment">#配置NAT，将内网IP地址转换为外网IP地址</span></span><br><span class="line">R1(config)<span class="comment">#ip nat inside source list 1 interface e0/0 overload </span></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;使用PC 1访问Internet：</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/02/w9JQk6.png"></p>
<ol start="6">
<li>在 ASW1 和 ASW2 上，采用合适的方式实现连着 PC 的接口避免 MAC 地址洪泛攻击，并且一个接口只允许接入一台 PC，当有非法 PC 接入时，能够产生告警消息。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ASW1(config)<span class="comment">#int range e0/1-2</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#switchport port-security maximum 1</span></span><br><span class="line">ASW2(config)<span class="comment">#int range e0/1-2</span></span><br><span class="line">ASW2(config-if-range)<span class="comment">#switchport port-security maximum 1</span></span><br></pre></td></tr></table></figure>

<ol start="7">
<li>将连接 PC1 的端口设置成该端口只允许 PC1 接入，实现任何情况下，其他主机都不允许通过该端口接入园区网络。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#将PC机与交换机对应的端口绑定起来，防止其他主机通过该端口接入园区网络</span></span><br><span class="line">ASW1(config)<span class="comment">#interface e0/1</span></span><br><span class="line">ASW1(config-if)<span class="comment">#switchport port-security mac-address sticky </span></span><br><span class="line">ASW1(config-if)<span class="comment">#switchport port-security mac-address 00:50:79:66:68:09</span></span><br><span class="line"></span><br><span class="line">ASW1(config)<span class="comment">#interface e0/2</span></span><br><span class="line">ASW1(config-if)<span class="comment">#switchport port-security mac-address sticky </span></span><br><span class="line">ASW1(config-if)<span class="comment">#switchport port-security mac-address 00:50:79:66:68:0a</span></span><br><span class="line"></span><br><span class="line">ASW2(config)<span class="comment">#int e0/1</span></span><br><span class="line">ASW2(config-if)<span class="comment">#switchport port-security mac-address sticky </span></span><br><span class="line">ASW2(config-if)<span class="comment">#switchport port-security mac-address 00:50:79:66:68:0b</span></span><br><span class="line"></span><br><span class="line">ASW2(config)<span class="comment">#int e0/2                                                    </span></span><br><span class="line">ASW2(config-if)<span class="comment">#switchport port-security mac-address sticky                 </span></span><br><span class="line">ASW2(config-if)<span class="comment">#switchport port-security mac-address 00:50:79:66:68:0c</span></span><br></pre></td></tr></table></figure>

<ol start="8">
<li>为了确保该园区网内的用户可以正常获取 IP 地址，避免未授权的 DHCP 服务器接入，在该园区网合适的交换机上部署 DHCP Snooping 技术，并且为了提高园区网的安全，最大限度的降低 ARP 攻击和 IP 地址欺骗等攻击对网络造成的影响，在合适的交换机上部署动态 ARP 检测和 IP 源防护技术。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在DSW2上部署DHCP Snooping 技术</span></span><br><span class="line">DSW2(config)<span class="comment">#ip dhcp snooping </span></span><br><span class="line"><span class="comment">#在ASW1部署动态ARP检测</span></span><br><span class="line">ASW1(config)<span class="comment">#ip arp inspection vlan 10 </span></span><br><span class="line"><span class="comment">#将e0/1设置为信任端口</span></span><br><span class="line">ASW1(config)<span class="comment">#interface range e0/1-2</span></span><br><span class="line"><span class="comment">#将非信任端口设置限制速率（此处的非信任端口为所有闲置端口）</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#ip arp inspection trust </span></span><br><span class="line">ASW1(config)<span class="comment">#interface range e0/0,e0/3,e0/2-3</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#ip arp inspection limit rate 10</span></span><br><span class="line"><span class="comment">#在e0/1、e0/2上部署IP源防护技术</span></span><br><span class="line">ASW1(config)<span class="comment">#interface range e0/1-2</span></span><br><span class="line">ASW1(config-if-range)<span class="comment">#ip verify source port-security</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>实现其他 PC 通过 ASW1 接入园区网络的时候，需要通过 802.1x 认证才能正常连入网络，如果PC 不支持802.1X 认证，那么就将该PC 划分到来宾VLAN60 里面，要求认证方式使用 AAA。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ASW1(config)<span class="comment">#aaa new-model </span></span><br><span class="line">ASW1(config)<span class="comment">#aaa authentication login default group radius local enable none </span></span><br></pre></td></tr></table></figure>

<ol start="10">
<li><p>在 ACS 上添加一个账户，用户名和密码自定，实现该用户通过 802.1x 验证后，就被自动划分到 VLAN50。</p>
</li>
<li><p>要求对所有设备的vty 登录都采用AAA 认证，并且当 AAA 服务器不可达时， 采用本地数据库进行认证。</p>
</li>
</ol>
<p>&emsp;&emsp;<strong>由于受到实验条件的限制，第10、11条要求暂时无法实现。</strong></p>
]]></content>
      <categories>
        <category>CCNP实验</category>
      </categories>
      <tags>
        <tag>CCNP</tag>
        <tag>交换</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2019/01/01/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<a id="more"></a>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>安恒杯四月月赛misc——Writeup</title>
    <url>/2020/04/27/%E5%AE%89%E6%81%92%E6%9D%AF%E5%9B%9B%E6%9C%88%E6%9C%88%E8%B5%9B%E2%80%94%E2%80%94Writeup/</url>
    <content><![CDATA[<p>&emsp;&emsp;内存取证还是蛮有意思的呀！</p>
<h3 id="1-6G还远吗？"><a href="#1-6G还远吗？" class="headerlink" title="1.6G还远吗？"></a>1.6G还远吗？</h3><p>​        文件下载下来，速度特别慢，但是在文件夹中用记事本打开即可发现flag。<a id="more"></a></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYltI.png" alt="0"></p>
<h3 id="2-blueshark"><a href="#2-blueshark" class="headerlink" title="2.blueshark"></a>2.blueshark</h3><p>​        在协议中搜索OBEX协议可以发现传输了一个what_you_want.7z文件。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYG1f.png" alt="01"></p>
<p>​        将what_you_want.7z导出，发现需要密码。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYJc8.png" alt="img"></p>
<p>​        根据文件名的提示找到pin，解压获得flag。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYa7j.png" alt="img"></p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqY0Nn.png" alt="img"></p>
<h3 id="3-keyboard"><a href="#3-keyboard" class="headerlink" title="3.keyboard"></a>3.keyboard</h3><p>​        解压后发现是一个Secret和一个Keyboard.raw。首先用010 Editor打开Secret，里面都是乱码，猜测可能是加密文件。</p>
<p>​        因此我们用kali自带的内存取证工具volatility对该内存进行操作。</p>
<p>​        首先获取该内存的配置文件</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYs3V.png"></p>
<p>​        查看进程，发现其使用了VeraCrypt，这说明之前的猜想是正确的，Secret是一个加密的磁盘文件。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqY6jU.png"></p>
<p>​        因此我们要寻找一个密码来对磁盘进行解密，我们在进程中找到了keyboard-log，因此使用filescan扫描文件，发现了t.txt文件。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqY2B4.png"></p>
<p>​        将其导出</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYfE9.png"></p>
<p>​        将文件打开后，发现密文，根据提示确定是qwe密码。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqY441.png"></p>
<p>​        解密得到磁盘密码<strong>KEYBOARDDRAOBYEK</strong>，使用VeraCrypt进行解密并挂载，获得here.vhd文件。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYo36.png"></p>
<p>​        用winhex打开即可找到flag。</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/08/30/dqYTgK.png"></p>
]]></content>
      <categories>
        <category>Writeup</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>网络安全</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机网络参考模型</title>
    <url>/2019/01/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B/</url>
    <content><![CDATA[<p>&emsp;&emsp;在计算机的网络中，有两个十分重要的参考模型，所有网络通信设备都是以参考模型为标准来研发的。因此熟知参考模型在学习网络知识的过程中是十分重要的。下面就简单的介绍一下两个参考模型。</p>
<a id="more"></a>

<p><strong>一、OSI参考模型</strong></p>
<p>&emsp;&emsp;OSI（Open System Interconnect），即开放式系统互联。 一般都叫OSI参考模型，是ISO（国际标准化组织）组织在1985年研究的网络互联模型。</p>
<p>&emsp;&emsp;它将网络划分成了七层，从下往依次为物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。</p>
<p>&emsp;&emsp;第一层<strong>物理层（physical layer）</strong>的主要功能:是完成相邻节点之间原始比特流的传输物理层的设计主要涉及物理接口的机械电气功能和过程特性，以及物理层接口连接的传输介质等问题。</p>
<p>&emsp;&emsp;第二层<strong>数据链路层（data link layer）</strong>负责将上层数据封装成固定格式的帧</p>
<p>&emsp;&emsp;第三层<strong>网络层(network layer）</strong>的主要功能:是实现数据从源端到目的端的传输</p>
<p>&emsp;&emsp;第四层<strong>传输层（transport layer）</strong>的主要功能:是实现网络中不同主机上用户进程之间的数据通信。</p>
<p>&emsp;&emsp;第五层<strong>会话层（session layer）</strong>允许不同机器上的用户之间建立会话关系。管理会话控制令牌管理（token management）数据中插入同步点</p>
<p>&emsp;&emsp;第六层<strong>表示层（presentation layer ）</strong>表示层以下各层只关心从源端机到目标机可靠地传输比特，而表示层关心的是所传输的语法和语义。用一种大家一致选定的标准方法对数据进行编码。同时，也能提供压缩解压、加密解密。</p>
<p>&emsp;&emsp;第七层<strong>应用层（application layer）</strong>应用层能与应用程序界面沟通，以达到展示给用户的目的。在此常见的协议有:HTTP，HTTPS，FTP，TELNET，SSH，SMTP，POP3等。</p>
<p>&emsp;&emsp;传输层要决定对会话层用户（最终的网络用户）提供什么样的服务。因此我们把1-3层的协议称为点对点的协议，而把4-7层的协议叫做端对端协议。</p>
<p><strong>二、TCP/IP参考模型</strong></p>
<p>&emsp;&emsp;TCP/IP参考模型是计算机网络的祖父ARPANET和其后续的因特网使用的参考模型。当无线网络和卫星出现以后，现有的协议在和它们相连的时候出现了问题，所以需要一种新的参考体系结构。这个体系结构在它的两个主要协议出现以后，被称为TCP/IP参考模型。</p>
<p>&emsp;&emsp;TCP/IP是如今用于现实网络互联的通信协议。TCP/IP参考模型以TCP/IP为核心，将协议分成四个层次，分别是：网络接口层、网路层、传输层、应用层。</p>
<p>&emsp;&emsp;但是由于TCP/IP的网络接口层并未定义该层的协议，且参与互联的各网络使用自己的物理层和数据链路层协议，然后与TCP/IP的网络接入层（即网络层）进行连接。所以后期的TCP/IP参考模型为五层：即将网络接口层分为物理层和数据链路层。</p>
<p>第一层<strong>网络接入层</strong></p>
<p>&emsp;&emsp;该层提供的服务与OSI参考模型中的物理层与数据链路层相对应。它负责监视数据在主机和网络之间的交换。事实上，TCP/IP本身并未定义该层的协议，而由参与互连的各网络使用自己的物理层和数据链路层协议，然后与TCP/IP的网络接入层进行连接。地址解析协议（ARP）工作在此层，即OSI参考模型的数据链路层。在前文也说过TCP/IP参考模型并未定义网络接入层的协议，又因为TCP/IP参考模型的广泛应用，所以为了方便理解网络接入层采用了OSI参考模型的物理层和数据链路层的定义。</p>
<p>第二层<strong>网络层</strong>  </p>
<p>&emsp;&emsp;网际互联层对应于OSI参考模型的网络层，主要解决主机到主机的通信问题。它所包含的协议设计数据包在整个网络上的逻辑传输。注重重新赋予主机一个IP地址来完成对主机的寻址，它还负责数据包在多种网络中的路由。该层有三个主要协议：网际协议（IP）、互联网组管理协议（IGMP）和互联网控制报文协议（ICMP）。</p>
<p>第三层<strong>传输层</strong></p>
<p>&emsp;&emsp;传输层对应于OSI参考模型的传输层，为应用层实体提供端到端的通信功能，保证了数据包的顺序传送及数据的完整性。该层定义了两个主要的协议：传输控制协议（TCP）和用户数据报协议（UDP)。</p>
<p>&emsp;&emsp;TCP协议提供的是一种可靠的、通过“三次握手”来连接的数据传输服务；而UDP协议提供的则是不保证可靠的（并不是不可靠）、无连接的数据传输服务。</p>
<p>第四层<strong>应用层</strong></p>
<p>&emsp;&emsp;应用层对应于OSI参考模型的高层，为用户提供所需要的各种服务，例如：FTP、Telnet、DNS、SMTP等。</p>
<p>&emsp;&emsp;以上就是计算机网络模型的大致内容，下面简单写下OSI参考模型和TCP/IP参考模型的<strong>异同点</strong>：</p>
<p><strong>共同点：</strong></p>
<p>&emsp;&emsp;（1）OSI参考模型和TCP/IP参考模型都采用了层次结构的概念。</p>
<p>&emsp;&emsp;（2）都能够提供面向连接和无连接两种通信服务机制。</p>
<p><strong>不同点：</strong></p>
<p>&emsp;&emsp;（1）OSI采用的七层模型，而TCP/IP是四层结构。</p>
<p>&emsp;&emsp;（2）TCP/IP参考模型的网络接口层实际上并没有真正的定义，只是一些概念性的描述。而OSI参考模型不仅分了两层，而且每一层的功能都很详尽，甚至在数据链路层又分出一个介质访问子层，专门解决局域网的共享介质问题。</p>
<p>&emsp;&emsp;（3）OSI模型是在协议开发前设计的，具有通用性。TCP/IP是先有协议集然后建立模型，不适用于非TCP/IP网络。</p>
<p>&emsp;&emsp;（4）OSI参考模型与TCP/IP参考模型的传输层功能基本相似，都是负责为用户提供真正的端对端的通信服务，也对高层屏蔽了底层网络的实现细节。所不同的是TCP/IP参考模型的传输层是建立在网络互联层基础之上的，而网络互联层只提供无连接的网络服务，所以面向连接的功能完全在TCP协议中实现，当然TCP/IP的传输层还提供无连接的服务，如UDP；相反OSI参考模型的传输层是建立在网络层基础之上的，网络层既提供面向连接的服务，又提供无连接的服务，但传输层只提供面向连接的服务。</p>
<p>&emsp;&emsp;（5）OSI参考模型的抽象能力高，适合与描述各种网络；而TCP/IP是先有了协议，才制定TCP/IP模型的。</p>
<p>&emsp;&emsp;（6）OSI参考模型的概念划分清晰，但过于复杂；而TCP/IP参考模型在服务、接口和协议的 区别上不清楚，功能描述和实现细节混在一起。</p>
<p>&emsp;&emsp;（7）TCP/IP参考模型的网络接口层并不是真正的一层；OSI参考模型的缺点是层次过多，划分意义不大但增加了复杂性。</p>
<p>&emsp;&emsp;（8）OSI参考模型虽然被看好，由于没把握好时机，技术不成熟，实现困难；相反，TCP/IP参考模型虽然有许多不尽人意的地方，但还是比较成功的。</p>
<p>&emsp;&emsp;本篇本章只是作者在学习过程中整理的一些笔记。仅仅对计算机网络参考模型做了简单的介绍，概念的定义是网上收集的一些资料。因此如果想要更深入学习计算机网络参考模型，可以查找更专业的书籍。</p>
]]></content>
      <categories>
        <category>网络基础</category>
      </categories>
      <tags>
        <tag>网络与数据通信</tag>
        <tag>CCNA</tag>
      </tags>
  </entry>
  <entry>
    <title>CCNP路由综合实验一</title>
    <url>/2019/03/28/CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80/</url>
    <content><![CDATA[<p>&emsp;&emsp;本篇文章主要介绍 OSPF 的基本配置；OSPF 网络类型的应用；不连续区域的网络环境及不连续区域对 OSPF 路由选择的影响； OSPF 不连续区域的几种解决方案； OSPF 区域间和外部路由的汇总； OSPF 默认路由的配置及控制。</p>
<a id="more"></a>

<p>【实验目的】</p>
<ol>
<li><p>熟悉 OSPF 的基本配置</p>
</li>
<li><p>熟悉OSPF 网络类型的应用</p>
</li>
<li><p>理解不连续区域的网络环境及不连续区域对 OSPF 路由选择的影响</p>
</li>
<li><p>掌握 OSPF 不连续区域的几种解决方案</p>
</li>
<li><p>掌握 OSPF 区域间和外部路由的汇总</p>
</li>
<li><p>掌握 OSPF 默认路由的配置及控制</p>
</li>
</ol>
<p>【实验拓扑】</p>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/03/wipiIP.png"></p>
<p>【实验需求】</p>
<ol>
<li>参考拓扑，完成各路由器的基本配置，除图示地址标识外，设备间的地址自己规划，并分别在路由器 R1、R2、R3、R5 和R6 上各起一个loopback 接口，地址为各路由器的编号，如 R1 的 loopback 地址就为 1.1.1.1，其他以此类推；</li>
</ol>
<p><img src="/images/loading.gif" data-original="https://s1.ax1x.com/2020/09/03/wipPat.png"></p>
<ol start="2">
<li>除ISP 区域外，全网启用 OSPF，并设置各路由器的 RID 为各路由器的编号，根据图示将各网段划分进相应的 OSPF 区域中，要求在 R5 上采用接口级命令将R5 相应的接口加入到 OSPF 区域中，在其他路由器上采用合适的方式启用 OSPF，并在 R2 上进行EIGRP 和 OSPF 的双向重分布；</li>
</ol>
<p>R1中的OSPF的配置：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image009.jpg" alt="img"></p>
<p>R2中的OSPF的配置：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image011.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image013.jpg" alt="img"></p>
<p>R5中的OSPF的配置：<img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image015.jpg" alt="img"></p>
<p>R9中的eigrp的配置：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image017.jpg" alt="img"></p>
<ol start="3">
<li>采用合适的命令观察 OSPF 的邻居表、拓扑表和路由表，仔细观察路由表的各路由类型，并测试图示标注loopback 接口网段间的连通性；</li>
</ol>
<p>R9中的loopback接口与R7中的loopback接口：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image019.jpg" alt="img"></p>
<p>R9中的loopback接口与R8中的loopback接口：</p>
<p><img src="/images/loading.gif" data-original="file:///C:/Users/ASUS/AppData/Local/Temp/msohtmlclip1/01/clip_image021.jpg" alt="img"></p>
<p>R9中的loopback接口与R4中的loopback接口：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image023.jpg" alt="img"></p>
<ol start="4">
<li>要求骨干区域能够快速收敛，并让R5 成为区域 578 中的 DR；</li>
</ol>
<p>要求骨干区域能够快速收敛，在骨干区域的路由器中配置点对点的OSPF</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image025.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image027.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image029.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image031.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image033.jpg" alt="img"></p>
<p>更改R5的优先级，让R5成为578区域的DR</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image035.jpg" alt="img"></p>
<ol start="5">
<li>采用合适的方案确保当骨干网络的任意链路中断的时候不会影响骨干网的连通性；</li>
</ol>
<p>在R3与R5中配置虚链路：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image037.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image039.jpg" alt="img"></p>
<p>将R1的e0/0端口关闭，验证其连通性：<br> <img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image041.jpg" alt="img"></p>
<ol start="6">
<li>观察各路由器上的路由表信息，然后在合适的路由器上进行必要的路由汇总，对比汇总之后各路由器路由表的变化，并观察和测试明细路由与汇总路由之间的关系；</li>
</ol>
<p>在各边界路由器上汇总路由：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image043.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image045.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image047.jpg" alt="img"></p>
<p>R1的路由表：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image049.jpg" alt="img"></p>
<ol start="7">
<li>采用合适的方案，实现图示标注的 loopback 网段可以访问 ISP 上的主机100.100.100.100；</li>
</ol>
<p>在R1和R6上配置NAT转换：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image051.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image053.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image055.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image057.jpg" alt="img"></p>
<p>验证其连通性：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image059.jpg" alt="img"></p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image061.jpg" alt="img"></p>
<ol start="8">
<li>要求各链路正常情况下，内网优选 ISP1 的链路对外部网络进行访问，当与 ISP1 的链路出现故障的时候，自动切换到 ISP2 的链路对外部网络进行访问，使用tracert 观察验证该现象。</li>
</ol>
<p>为使内网优先选择ISP1对外部网络进行访问，故更改链路的cost值，使内网从ISP1访问外网的cost比从ISP2访问外网的cost小：</p>
<p>验证结果如下：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image063.jpg" alt="img"></p>
<p>当ISP1出现故障时（关闭R1中的S1/0端口）：</p>
<p><img src="/images/loading.gif" data-original="CCNP%E8%B7%AF%E7%94%B1%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C%E4%B8%80.assets/clip_image065.jpg" alt="img"></p>
]]></content>
      <categories>
        <category>CCNP实验</category>
      </categories>
      <tags>
        <tag>CCNP</tag>
        <tag>路由</tag>
        <tag>OSPF</tag>
      </tags>
  </entry>
</search>
